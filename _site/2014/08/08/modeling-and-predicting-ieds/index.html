<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.5.1 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Modeling and predicting IEDs - MI Regression</title>




<meta name="description" content="This first appeared on Predictive Heuristics, my employer’s blog.">




<meta name="author" content="Andreas Beger">

<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="MI Regression">
<meta property="og:title" content="Modeling and predicting IEDs">


  <link rel="canonical" href="http://localhost:4000/2014/08/08/modeling-and-predicting-ieds/">
  <meta property="og:url" content="http://localhost:4000/2014/08/08/modeling-and-predicting-ieds/">



  <meta property="og:description" content="This first appeared on Predictive Heuristics, my employer’s blog.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2014-08-08T22:10:50+03:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Andreas Beger",
      "url" : "http://localhost:4000",
      "sameAs" : ["https://twitter.com/andybeega","https://www.linkedin.com/in/andreas-beger-67728a36","https://plus.google.com/111153267456095139645","https://scholar.google.com/citations?user=0QX5DXoAAAAJ"]
    }
  </script>



  <meta name="google-site-verification" content="cuymuwKhb4ZRPa4fX0BANEZvI3px-I4kRwScJhVEV1I" />




<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="MI Regression Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->

<meta http-equiv="cleartype" content="on">

<!-- MathJax support (took out async) -->
<script type="text/javascript" 
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/">MI Regression</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/year-archive/">Blog archive</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/papers/">Projects & Papers</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/about/">About</a></li>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    



<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="http://localhost:4000/images/mugshot2017.jpg" class="author__avatar" alt="Andreas Beger" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">Andreas Beger</h3>
    
      <p class="author__bio" itemprop="description">
        Conflict forecasting, data science
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Tallinn, Estonia</span>
        </li>
      

      

      
        <li>
          <a href="mailto:adbeger+mireg@gmail.com">
            <meta itemprop="email" content="adbeger+mireg@gmail.com" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      
        <li>
          <a href="https://twitter.com/andybeega" itemprop="sameAs">
            <i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/andybega" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Modeling and predicting IEDs">
    <meta itemprop="description" content="This first appeared on Predictive Heuristics, my employer’s blog.">
    <meta itemprop="datePublished" content="August 08, 2014">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Modeling and predicting IEDs
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  8 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <p><em>This first appeared on <a href="http://predictiveheuristics.com/">Predictive Heuristics</a>, my employer’s blog.</em></p>

<p>Improvised explosive devices, or IEDs, were extensively used during the US wars in Iraq and Afghanistan, <a href="http://www.history.navy.mil/library/online/ied.htm">causing half of all US and coalition casualties</a> despite increasingly sophisticated countermeasures. Although both of these wars have come to a close, it is unlikely that the threat of IEDs will disappear. If anything, their success implies that US and European forces are more likely to face them in similar future conflicts. As a result there is value in understanding the process by which they are employed, and being able to predict where and when they will be used. This is a goal we have been working on for some time now as part of a project funded by the Office of Naval Research, using SIGACT event data on IEDs and other forms of violence in Afghanistan.</p>

<figure>
  
<a href="http://localhost:4000/content/2014/expl-haz.png"><img src="http://localhost:4000/content/2014/expl-haz.png" alt="Map of IEDs in Afghanistan" /></a>

  <figcaption>
Explosive hazards, which include IEDs, for our SIGACT data.
</figcaption>
</figure>

<p>The use of IEDs itself is not new at all. Mines, booby traps, or other similar improvised devices have been used for hundreds of years. Examples abound. Lawrence of Arabia, in <em>Seven Pillars of Wisdom</em>, discusses their use against the Ottomans in Arabia during World War 1 to some length, and more recent conflicts in which they figure prominently include the Vietnam War and the Northern Ireland Troubles.</p>

<p>What has changed in the past 10 or 20 years <a href="http://www.brookings.edu/research/articles/2012/02/improvised-explosive-devices-singer">is not the fact that they are used, but the importance they have taken on</a>, both in the volume of use and their effectiveness in causing casualties. The incentive structures underlying this trend have, arguably, made them a weapon of choice in asymetric conflicts where emerging, low-tech forces face advanced professional militaries. Western democracies are casualty averse, leading to armies that are increasingly well protected with equipment like <a href="http://en.wikipedia.org/wiki/V-hull">mine-resistant</a> <a href="http://en.wikipedia.org/wiki/MRAP">vehicles</a> and <a href="http://en.wikipedia.org/wiki/Counter_Rocket,_Artillery,_and_Mortar">Iron Dome-like defenses</a> (<a href="https://www.youtube.com/watch?v=ILcVt9p7cug">video</a>) against mortar and rocket fire, and which can respond to the enemy with obscene amounts of firepower and surveillance capability, e.g. drones and 500lbs bombs against people burying IEDs.</p>

<p>In the cost part of the equation, the internet has made it easier to disseminate the know-how for making explosives and building various devices, and the broad range of modern electronics makes it possible to remotely trigger bombs without exposing oneself to direct retaliation.</p>

<p>In sum, IEDs are not going away. If professional militaries continue to become better protected and armed, and IEDs with complex remote triggers easier to make, they will if anything become more prevalent.</p>

<p>In our effort to model and predict IEDs in Afghanistan, we have tried to push resolution to the most-detailed level possible, and far below the common country-year unit, in order to be able to predict at a level that is operationally relevant. The limits on how low we could go were set by the data available to us, and along the way have created unexpected challenges that forced us to adapt to modeling on the cusp of somewhat big data.</p>

<p>Our data on IEDs come from a declassified set of SIGACTs–significant activities reports–for 2009 and parts of 2010 in Afghanistan, shown in the figure above. These are short reports on engagements with the enemy and other kinds of events that were/are routinely collected by US forces in both Afghanistan and Iraq in the course of tactical operations, and which heavily inform the picture higher levels have of the larger conflict. In the world of political science and conflict research, the SIGACTs are essentially event data, albeit not collected on the basis of media/news reports, as most other efforts are (e.g. <a href="http://www.acleddata.com/">ACLED</a>, <a href="http://www.pcr.uu.se/research/ucdp/datasets/ucdp_ged/">UCDP GED</a>, <a href="https://www.strausscenter.org/scad.html">SCAD</a>). Larger subsets of the SIGACT database are the basis for the WikiLeaks war logs as well, which most people are probably more familiar with. Unlike those, our data are officially sanctioned, but similar to WikiLeaks they are degraded and censored to obscure some information.</p>

<p>Temporally, our SIGACT and thus IED data are resolved to the day. The locations are more accurate but given the resolution of other spatial variables that we considered as potential covariates we decided to use 1 by 1 kilometer squares as our spatial unit. Our unit of observation thus is a 1km<sup>2</sup> cell-day.</p>

<p>This is smaller than typical compared to work in the “disaggregating civil war” vein, but not unprecedented. For example, in a project on reciprocity of violence in Iraq, <a href="http://www.tandfonline.com/doi/abs/10.1080/03050629.2012.696996#.U-SQboCSz_8">Linke et al</a> (gated) use 1km<sup>2</sup> cells with 3-day windows for Baghdad, and 10km<sup>2</sup> cells for the rest of the country. But it is small enough that modeling all of Afghanistan is a bit too high of a goal. To make the problem more tractable we decided to instead focus on smaller areas of the country that appeared to contain sufficient numbers of IED events. For convenience we settled on 100 by 100 km grids, which gives us 10,000 cells per day.</p>

<figure>
  
<a href="http://localhost:4000/content/2014/grid-map.png"><img src="http://localhost:4000/content/2014/grid-map.png" alt="Map of data grids in Afghanistan" /></a>

  <figcaption>
Location of the two grids near Ghazni and Lashkar Gah.
</figcaption>
</figure>

<p>As our interest is in prediction, we need a way to evaluate how well our model predicts out of sample. Model fit in sample, with the data used to estimate the model parameters, is usually an optimistic indication of out of sample fit due to overfitting. To that end we use data from two areas, shown in the map above, and split into two time periods. The first area in the east is near the city of Ghazni and we use the first 10 months in 2009 for training data that is used to estimate the models. Data from the next five months, into the end of Q1 2010, for both areas is used for two test sets. This allows us to test how well our models, estimated with data from Ghazni, predict future IEDs in Ghazni, but also how well they generalize across space with the Lashkar Gah test set.</p>

<p>We chose the two grids on the basis of superficial similarity: both are centered and mid-sized cities on the ring road, and both experienced fairly high levels of IED activity. The distribution of IEDs in both areas is shown in the figure below, with separate maps for the training and test time periods. It’s immediately apparent that the southern area near Lashkar Gah had an overall higher level of violence, and that events were more concentrated geographically to the irrigated areas south of Lashkar Gah (which interestingly were irrigated with <a href="http://en.wikipedia.org/wiki/Helmand_and_Arghandab_Valley_Authority">help from the US in the 1950’s</a>). There is also a marked uptick in early 2010 that corresponds to the US offensive around Marja–<a href="http://en.wikipedia.org/wiki/Operation_Moshtarak">Operation Moshtarak</a>.</p>

<figure>
  
<a href="http://localhost:4000/content/2014/observed_ieds.png"><img src="http://localhost:4000/content/2014/observed_ieds.png" alt="Observed IEDs" /></a>

  <figcaption>
Observed IED counts and frequency by week for the two grids over the training and test time periods.
</figcaption>
</figure>

<p>Our modeling problem is in a general sense a question of binary classification: we want to predict whether a cell has an IED on a given day or not, i.e. just a 0 or 1 prediction. Like similar problems in international relations, the events in our data are rare, although much rarer than the usual rare events data. Our setup, with ~1km<sup>2</sup> cells observed over 304 days in the training period, gives us 3.04 million data points for the training data that among them contain 432 positive events. So even though visually there appear to be a large number of events, our resolution leads us to sparse data in the end. In the two test sets we have 1.51 million data points each with 117 and 988 IED events respectively. The base rates, or the naïve probability that any cell-day had an IED, across our data sets are 1.4, 0.8, and 6.4 in 10,000. Those are percents of a percent, and obviously very low.</p>

<p>One of the strategies we <a href="http://predictiveheuristics.com/2014/05/22/the-coup-in-thailand-and-progress-in-forecasting/">have relied on</a> for dealing with rare data is to use split-population duration models. Like regular duration models a la Weibull, they allow us to account for temporal dependence, but they are also sensitive to the fact that most areas like a mountain top or the middle of the desert far away from a road will never experience an IED. They do so by simultaneously estimating the chances that a cell-day is in the risk set of observations that will experience an IED at some point in the future and the probability that those at risk will have an IED event now, not later. One of the advantages in estimating what cell-days are at risk for an IED rather than dropping mountain tops from our data is that it allows us to identify border cases where the lack of risk is less obvious. By identifying subsets not at risk it allows us to deal with excess 0’s in our data in a way similar to zero-inflated models.</p>

<figure>
  
<a href="http://localhost:4000/content/2014/sppop_graph.png"><img src="http://localhost:4000/content/2014/sppop_graph.png" alt="Split-population graph" /></a>

  <figcaption>
Split-population duration intuition: first, the model separates cases that are likely to experience an event in the future at all, and second it estimates the likely time until such an event for cases at risk of any event.
</figcaption>
</figure>

<p>Our initial models, so far largely based on temporally-invariant spatial variables, reach AUCs of 0.85 to 0.90, which is decent in an absolute sense, but that with the sparsity in our data leads to too low precision for any reasonable level of recall. Precision, for those not familiar, is essentially a measure of how confident we can be in our model’s predictions, i.e. the predicted positives will really be IED events, and recall indicates what fraction of IED events are captured by our model, i.e. how broad it is. One the bright side, it looks like the results easily generalize to our two test sets, which leaves us with some confidence that it would work in other contexts as well.</p>

<hr />

<p>On a final note, I’d like to add that this project is close to my heart for personal reasons. Three years into graduate school I was sent to Iraq and a big part of my job was to predict IEDs. It was very difficult, for various reasons. Difficult even though we had access to resources that won’t come to American universities anytime soon, including more detailed SIGACTs and event information. One of the challenges was in assessing the effect of various indicators, i.e. multivariate analysis, which is something much easier to do in the quantitative world. So even though the information we have is limited, I’m excited to see how well our effort will turn out.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/tags/#afghanistan" class="page__taxonomy-item" rel="tag">Afghanistan</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#counter-ied" class="page__taxonomy-item" rel="tag">counter-IED</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#ied" class="page__taxonomy-item" rel="tag">IED</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/categories/#post" class="page__taxonomy-item" rel="tag">post</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2014-08-08T22:10:50+03:00">August 08, 2014</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Modeling+and+predicting+IEDs%20http%3A%2F%2Flocalhost%3A4000%2F2014%2F08%2F08%2Fmodeling-and-predicting-ieds%2F" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2014%2F08%2F08%2Fmodeling-and-predicting-ieds%2F" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2F2014%2F08%2F08%2Fmodeling-and-predicting-ieds%2F" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2014%2F08%2F08%2Fmodeling-and-predicting-ieds%2F" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="http://localhost:4000/2014/05/23/the-thailand-coup-and-some-recent-forecasting-work/" class="pagination--pager" title="The Thailand coup and some recent forecasting work
">Previous</a>
    
    
      <a href="http://localhost:4000/2014/09/19/baby-steps-with-r-shiny/" class="pagination--pager" title="Baby steps with R Shiny
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
    
        <h4 class="page__comments-title">Leave a Comment</h4>
        <section id="disqus_thread"></section>
      
</div>
    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/andybega"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 Andreas Beger. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36796505-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




  
      
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/2014/08/08/modeling-and-predicting-ieds/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/2014/08/08/modeling-and-predicting-ieds"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://mireg.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    



  </body>
</html>
